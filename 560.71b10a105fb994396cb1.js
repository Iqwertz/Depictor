"use strict";(self.webpackChunkselfie_drawer=self.webpackChunkselfie_drawer||[]).push([[560],{6560:(Te,L,l)=>{l.r(L),l.d(L,{GcodeModule:()=>De});var g=l(8583),m=l(9320),t=l(3018);let F=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-gcode"]],decls:1,vars:0,template:function(e,i){1&e&&t._UZ(0,"router-outlet")},directives:[m.lC],styles:[""]}),n})();var p=l(2340),y=l(5608),u=l(6432);const Y=["canvas"];let M=(()=>{class n{constructor(e){this.gcodeViewerService=e,this.strokeColor="#2E2E2E",this.drawingStrokeColor="#9e9e9e",this.offset=[0,0],this.lastDrawingCommand="",this.lastDrawingPosition=0,this.bounds=[],this.height=window.innerHeight-250,this.width=window.innerWidth/2,this.gcodeFile="",this.rendererConfigInput={},this.progress=0,this.rendererConfig={drawing:!1,gcodeScale:0,notRenderdLines:0,strokeColor:"",strokeColorPassive:"",strokeWidth:0,drawingOffset:[0,0]},this.canvas=null,this.ctx=null}ngOnInit(){}ngAfterViewInit(){!this.canvas||(this.rendererConfig={gcodeScale:this.rendererConfigInput.gcodeScale||4.5,notRenderdLines:this.rendererConfigInput.notRenderdLines||0,strokeColor:this.rendererConfigInput.strokeColor||"#2E2E2E",strokeColorPassive:this.rendererConfigInput.strokeColorPassive||"#9e9e9e",strokeWidth:this.rendererConfigInput.strokeWidth||1,drawing:this.rendererConfigInput.drawing||!1,drawingOffset:this.rendererConfigInput.drawingOffset||[0,0]},this.height=window.innerHeight-250,this.width=window.innerWidth/2,window.innerWidth<700&&(this.width=window.innerWidth-20),this.canvas.nativeElement.width=this.width,this.canvas.nativeElement.height=this.height,this.ctx=this.canvas.nativeElement.getContext("2d"),this.ctx&&(this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,this.width,this.height),this.gcodeFile.length>0&&this.render()))}renderGcode(e,i){this.gcodeFile=e,this.rendererConfig={gcodeScale:i.gcodeScale||4.5,notRenderdLines:i.notRenderdLines||0,strokeColor:i.strokeColor||"#2E2E2E",strokeColorPassive:i.strokeColorPassive||"#9e9e9e",strokeWidth:i.strokeWidth||1,drawing:i.drawing||!1,drawingOffset:i.drawingOffset||[0,0]},this.render()}updateDrawingGcode(e){if(this.progress=e,this.progress>this.lastDrawingPosition){let r=this.gcodeFile.split(/\r?\n/).slice(this.lastDrawingPosition,this.progress);r[r.length-1].startsWith("G")&&(this.drawGcode(r.join("\n"),this.rendererConfig.gcodeScale,this.rendererConfig.strokeColor,this.rendererConfig.notRenderdLines,this.offset,!1,!0,this.lastDrawingCommand),this.lastDrawingCommand=r[r.length-1],this.lastDrawingPosition=this.progress)}}render(){if(!this.canvas)return;this.bounds=this.getBiggestValue(this.gcodeFile),this.offset=[0,0],this.canvas.nativeElement.width/this.canvas.nativeElement.height<this.bounds[0]/this.bounds[1]?(this.rendererConfig.gcodeScale=this.canvas.nativeElement.width/this.bounds[0],this.offset[1]=(this.canvas.nativeElement.height-this.bounds[1]*this.rendererConfig.gcodeScale)/2):(this.rendererConfig.gcodeScale=this.canvas.nativeElement.height/this.bounds[1],this.offset[0]=(this.canvas.nativeElement.width-this.bounds[0]*this.rendererConfig.gcodeScale)/2),this.offset[0]+=this.rendererConfig.drawingOffset[0]*(this.rendererConfig.gcodeScale/2),this.offset[1]+=this.rendererConfig.drawingOffset[1]*(this.rendererConfig.gcodeScale/2);let e=this.rendererConfig.strokeColor;this.rendererConfig.drawing&&(e=this.rendererConfig.strokeColorPassive),console.log(this.rendererConfig),this.drawGcode(this.gcodeFile,this.rendererConfig.gcodeScale,e,this.rendererConfig.notRenderdLines,this.offset,!0,!1,null)}getBiggestValue(e){let i=e.split(/\r?\n/),r=[0,0];for(let o of i){let a=this.getG1Parameter(o);a[0]>r[0]&&(r[0]=a[0]),a[1]>r[1]&&(r[1]=a[1])}return r}drawGcode(e,i,r,o,a,d,w,C){if(d&&this.clearCanvas(),!this.ctx)return;this.ctx.strokeStyle=r;let c=e.split(/\r?\n/),v=!1,_=[0,0];C&&(_=this.getG1Parameter(C));let Z=c.length-o;Z<=0&&(Z=0),this.ctx.beginPath();for(let G=0;G<Z;G++){let D=c[G];if(D.startsWith("G1")){let A=this.getG1Parameter(D);(v||w)&&(this.ctx.moveTo(_[0]*i+a[0],_[1]*i+a[1]),this.ctx.lineTo(A[0]*i+a[0],A[1]*i+a[1])),_=A}else D.startsWith("M05")?v=!1:D.startsWith("M03")&&(v=!0)}this.ctx.stroke()}clearCanvas(){if(!this.ctx)return;const e=this.ctx.canvas;this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,e.width,e.height),this.ctx.restore(),this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,this.width,this.height)}getG1Parameter(e){return[parseFloat(e.substring(e.indexOf("X")+1,e.lastIndexOf("Y")).trim()),parseFloat(e.substring(e.indexOf("Y")+1,e.length).trim())]}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.k))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-canvas-gcode-renderer"]],viewQuery:function(e,i){if(1&e&&t.Gf(Y,5),2&e){let r;t.iGM(r=t.CRH())&&(i.canvas=r.first)}},inputs:{gcodeFile:["gcode","gcodeFile"],rendererConfigInput:["config","rendererConfigInput"]},decls:2,vars:0,consts:[["canvas",""]],template:function(e,i){1&e&&t._UZ(0,"canvas",null,0)},styles:["canvas[_ngcontent-%COMP%]{border-radius:15px;border:3px solid #000}"]}),n})();var x=l(6022),T=l(4164),P=l(8645),I=l(1114),k=l(2458),b=l(9490),f=l(6461),O=l(3679),R=l(6237),H=l(521),J=l(5319),N=l(4765),Q=l(946);const j=["sliderWrapper"],h=(0,H.i$)({passive:!1}),K={provide:O.JU,useExisting:(0,t.Gpc)(()=>z),multi:!0};class ee{}const te=(0,k.sb)((0,k.pj)((0,k.Id)(class{constructor(n){this._elementRef=n}}),"accent"));let z=(()=>{class n extends te{constructor(e,i,r,o,a,d,w,C){super(e),this._focusMonitor=i,this._changeDetectorRef=r,this._dir=o,this._ngZone=d,this._animationMode=C,this._invert=!1,this._max=100,this._min=0,this._step=1,this._thumbLabel=!1,this._tickInterval=0,this._value=null,this._vertical=!1,this.change=new t.vpe,this.input=new t.vpe,this.valueChange=new t.vpe,this.onTouched=()=>{},this._percent=0,this._isSliding=null,this._isActive=!1,this._tickIntervalPercent=0,this._sliderDimensions=null,this._controlValueAccessorChangeFn=()=>{},this._dirChangeSubscription=J.w.EMPTY,this._pointerDown=c=>{this.disabled||this._isSliding||!S(c)&&0!==c.button||this._ngZone.run(()=>{this._touchId=S(c)?function(n,s){for(let e=0;e<n.touches.length;e++){const i=n.touches[e].target;if(s===i||s.contains(i))return n.touches[e].identifier}}(c,this._elementRef.nativeElement):void 0;const v=V(c,this._touchId);if(v){const _=this.value;this._isSliding="pointer",this._lastPointerEvent=c,c.preventDefault(),this._focusHostElement(),this._onMouseenter(),this._bindGlobalEvents(c),this._focusHostElement(),this._updateValueFromPosition(v),this._valueOnSlideStart=_,_!=this.value&&this._emitInputEvent()}})},this._pointerMove=c=>{if("pointer"===this._isSliding){const v=V(c,this._touchId);if(v){c.preventDefault();const _=this.value;this._lastPointerEvent=c,this._updateValueFromPosition(v),_!=this.value&&this._emitInputEvent()}}},this._pointerUp=c=>{"pointer"===this._isSliding&&(!S(c)||"number"!=typeof this._touchId||E(c.changedTouches,this._touchId))&&(c.preventDefault(),this._removeGlobalEvents(),this._isSliding=null,this._touchId=void 0,this._valueOnSlideStart!=this.value&&!this.disabled&&this._emitChangeEvent(),this._valueOnSlideStart=this._lastPointerEvent=null)},this._windowBlur=()=>{this._lastPointerEvent&&this._pointerUp(this._lastPointerEvent)},this._document=w,this.tabIndex=parseInt(a)||0,d.runOutsideAngular(()=>{const c=e.nativeElement;c.addEventListener("mousedown",this._pointerDown,h),c.addEventListener("touchstart",this._pointerDown,h)})}get invert(){return this._invert}set invert(e){this._invert=(0,b.Ig)(e)}get max(){return this._max}set max(e){this._max=(0,b.su)(e,this._max),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get min(){return this._min}set min(e){this._min=(0,b.su)(e,this._min),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get step(){return this._step}set step(e){this._step=(0,b.su)(e,this._step),this._step%1!=0&&(this._roundToDecimal=this._step.toString().split(".").pop().length),this._changeDetectorRef.markForCheck()}get thumbLabel(){return this._thumbLabel}set thumbLabel(e){this._thumbLabel=(0,b.Ig)(e)}get tickInterval(){return this._tickInterval}set tickInterval(e){this._tickInterval="auto"===e?"auto":"number"==typeof e||"string"==typeof e?(0,b.su)(e,this._tickInterval):0}get value(){return null===this._value&&(this.value=this._min),this._value}set value(e){if(e!==this._value){let i=(0,b.su)(e,0);this._roundToDecimal&&i!==this.min&&i!==this.max&&(i=parseFloat(i.toFixed(this._roundToDecimal))),this._value=i,this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}}get vertical(){return this._vertical}set vertical(e){this._vertical=(0,b.Ig)(e)}get displayValue(){return this.displayWith?this.displayWith(this.value):this._roundToDecimal&&this.value&&this.value%1!=0?this.value.toFixed(this._roundToDecimal):this.value||0}focus(e){this._focusHostElement(e)}blur(){this._blurHostElement()}get percent(){return this._clamp(this._percent)}_shouldInvertAxis(){return this.vertical?!this.invert:this.invert}_isMinValue(){return 0===this.percent}_getThumbGap(){return this.disabled?7:this._isMinValue()&&!this.thumbLabel?this._isActive?10:7:0}_getTrackBackgroundStyles(){const i=this.vertical?`1, ${1-this.percent}, 1`:1-this.percent+", 1, 1";return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"-":""}${this._getThumbGap()}px) scale3d(${i})`}}_getTrackFillStyles(){const e=this.percent,r=this.vertical?`1, ${e}, 1`:`${e}, 1, 1`;return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"":"-"}${this._getThumbGap()}px) scale3d(${r})`,display:0===e?"none":""}}_getTicksContainerStyles(){return{transform:`translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"-":""}${this._tickIntervalPercent/2*100}%)`}}_getTicksStyles(){let e=100*this._tickIntervalPercent,d={backgroundSize:this.vertical?`2px ${e}%`:`${e}% 2px`,transform:`translateZ(0) translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"":"-"}${e/2}%)${this.vertical||"rtl"!=this._getDirection()?"":" rotate(180deg)"}`};if(this._isMinValue()&&this._getThumbGap()){const w=this._shouldInvertAxis();let C;C=this.vertical?w?"Bottom":"Top":w?"Right":"Left",d[`padding${C}`]=`${this._getThumbGap()}px`}return d}_getThumbContainerStyles(){const e=this._shouldInvertAxis();return{transform:`translate${this.vertical?"Y":"X"}(-${100*(("rtl"!=this._getDirection()||this.vertical?e:!e)?this.percent:1-this.percent)}%)`}}_shouldInvertMouseCoords(){const e=this._shouldInvertAxis();return"rtl"!=this._getDirection()||this.vertical?e:!e}_getDirection(){return this._dir&&"rtl"==this._dir.value?"rtl":"ltr"}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{this._isActive=!!e&&"keyboard"!==e,this._changeDetectorRef.detectChanges()}),this._dir&&(this._dirChangeSubscription=this._dir.change.subscribe(()=>{this._changeDetectorRef.markForCheck()}))}ngOnDestroy(){const e=this._elementRef.nativeElement;e.removeEventListener("mousedown",this._pointerDown,h),e.removeEventListener("touchstart",this._pointerDown,h),this._lastPointerEvent=null,this._removeGlobalEvents(),this._focusMonitor.stopMonitoring(this._elementRef),this._dirChangeSubscription.unsubscribe()}_onMouseenter(){this.disabled||(this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent())}_onFocus(){this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent()}_onBlur(){this.onTouched()}_onKeydown(e){if(this.disabled||(0,f.Vb)(e)||this._isSliding&&"keyboard"!==this._isSliding)return;const i=this.value;switch(e.keyCode){case f.Ku:this._increment(10);break;case f.VM:this._increment(-10);break;case f.uR:this.value=this.max;break;case f.Sd:this.value=this.min;break;case f.oh:this._increment("rtl"==this._getDirection()?1:-1);break;case f.LH:this._increment(1);break;case f.SV:this._increment("rtl"==this._getDirection()?-1:1);break;case f.JH:this._increment(-1);break;default:return}i!=this.value&&(this._emitInputEvent(),this._emitChangeEvent()),this._isSliding="keyboard",e.preventDefault()}_onKeyup(){"keyboard"===this._isSliding&&(this._isSliding=null)}_getWindow(){return this._document.defaultView||window}_bindGlobalEvents(e){const i=this._document,r=S(e),a=r?"touchend":"mouseup";i.addEventListener(r?"touchmove":"mousemove",this._pointerMove,h),i.addEventListener(a,this._pointerUp,h),r&&i.addEventListener("touchcancel",this._pointerUp,h);const d=this._getWindow();void 0!==d&&d&&d.addEventListener("blur",this._windowBlur)}_removeGlobalEvents(){const e=this._document;e.removeEventListener("mousemove",this._pointerMove,h),e.removeEventListener("mouseup",this._pointerUp,h),e.removeEventListener("touchmove",this._pointerMove,h),e.removeEventListener("touchend",this._pointerUp,h),e.removeEventListener("touchcancel",this._pointerUp,h);const i=this._getWindow();void 0!==i&&i&&i.removeEventListener("blur",this._windowBlur)}_increment(e){this.value=this._clamp((this.value||0)+this.step*e,this.min,this.max)}_updateValueFromPosition(e){if(!this._sliderDimensions)return;let a=this._clamp(((this.vertical?e.y:e.x)-(this.vertical?this._sliderDimensions.top:this._sliderDimensions.left))/(this.vertical?this._sliderDimensions.height:this._sliderDimensions.width));if(this._shouldInvertMouseCoords()&&(a=1-a),0===a)this.value=this.min;else if(1===a)this.value=this.max;else{const d=this._calculateValue(a),w=Math.round((d-this.min)/this.step)*this.step+this.min;this.value=this._clamp(w,this.min,this.max)}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.value),this.valueChange.emit(this.value),this.change.emit(this._createChangeEvent())}_emitInputEvent(){this.input.emit(this._createChangeEvent())}_updateTickIntervalPercent(){if(this.tickInterval&&this._sliderDimensions)if("auto"==this.tickInterval){let e=this.vertical?this._sliderDimensions.height:this._sliderDimensions.width,o=Math.ceil(30/(e*this.step/(this.max-this.min)))*this.step;this._tickIntervalPercent=o/e}else this._tickIntervalPercent=this.tickInterval*this.step/(this.max-this.min)}_createChangeEvent(e=this.value){let i=new ee;return i.source=this,i.value=e,i}_calculatePercentage(e){return((e||0)-this.min)/(this.max-this.min)}_calculateValue(e){return this.min+e*(this.max-this.min)}_clamp(e,i=0,r=1){return Math.max(i,Math.min(e,r))}_getSliderDimensions(){return this._sliderWrapper?this._sliderWrapper.nativeElement.getBoundingClientRect():null}_focusHostElement(e){this._elementRef.nativeElement.focus(e)}_blurHostElement(){this._elementRef.nativeElement.blur()}writeValue(e){this.value=e}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.SBq),t.Y36(N.tE),t.Y36(t.sBO),t.Y36(Q.Is,8),t.$8M("tabindex"),t.Y36(t.R0b),t.Y36(g.K0),t.Y36(R.Qb,8))},n.\u0275cmp=t.Xpm({type:n,selectors:[["mat-slider"]],viewQuery:function(e,i){if(1&e&&t.Gf(j,5),2&e){let r;t.iGM(r=t.CRH())&&(i._sliderWrapper=r.first)}},hostAttrs:["role","slider",1,"mat-slider","mat-focus-indicator"],hostVars:29,hostBindings:function(e,i){1&e&&t.NdJ("focus",function(){return i._onFocus()})("blur",function(){return i._onBlur()})("keydown",function(o){return i._onKeydown(o)})("keyup",function(){return i._onKeyup()})("mouseenter",function(){return i._onMouseenter()})("selectstart",function(o){return o.preventDefault()}),2&e&&(t.Ikx("tabIndex",i.tabIndex),t.uIk("aria-disabled",i.disabled)("aria-valuemax",i.max)("aria-valuemin",i.min)("aria-valuenow",i.value)("aria-valuetext",null==i.valueText?i.displayValue:i.valueText)("aria-orientation",i.vertical?"vertical":"horizontal"),t.ekj("mat-slider-disabled",i.disabled)("mat-slider-has-ticks",i.tickInterval)("mat-slider-horizontal",!i.vertical)("mat-slider-axis-inverted",i._shouldInvertAxis())("mat-slider-invert-mouse-coords",i._shouldInvertMouseCoords())("mat-slider-sliding",i._isSliding)("mat-slider-thumb-label-showing",i.thumbLabel)("mat-slider-vertical",i.vertical)("mat-slider-min-value",i._isMinValue())("mat-slider-hide-last-tick",i.disabled||i._isMinValue()&&i._getThumbGap()&&i._shouldInvertAxis())("_mat-animation-noopable","NoopAnimations"===i._animationMode))},inputs:{disabled:"disabled",color:"color",tabIndex:"tabIndex",invert:"invert",max:"max",min:"min",step:"step",thumbLabel:"thumbLabel",tickInterval:"tickInterval",value:"value",vertical:"vertical",displayWith:"displayWith",valueText:"valueText"},outputs:{change:"change",input:"input",valueChange:"valueChange"},exportAs:["matSlider"],features:[t._Bn([K]),t.qOj],decls:13,vars:6,consts:[[1,"mat-slider-wrapper"],["sliderWrapper",""],[1,"mat-slider-track-wrapper"],[1,"mat-slider-track-background",3,"ngStyle"],[1,"mat-slider-track-fill",3,"ngStyle"],[1,"mat-slider-ticks-container",3,"ngStyle"],[1,"mat-slider-ticks",3,"ngStyle"],[1,"mat-slider-thumb-container",3,"ngStyle"],[1,"mat-slider-focus-ring"],[1,"mat-slider-thumb"],[1,"mat-slider-thumb-label"],[1,"mat-slider-thumb-label-text"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0,1),t.TgZ(2,"div",2),t._UZ(3,"div",3),t._UZ(4,"div",4),t.qZA(),t.TgZ(5,"div",5),t._UZ(6,"div",6),t.qZA(),t.TgZ(7,"div",7),t._UZ(8,"div",8),t._UZ(9,"div",9),t.TgZ(10,"div",10),t.TgZ(11,"span",11),t._uU(12),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngStyle",i._getTrackBackgroundStyles()),t.xp6(1),t.Q6J("ngStyle",i._getTrackFillStyles()),t.xp6(1),t.Q6J("ngStyle",i._getTicksContainerStyles()),t.xp6(1),t.Q6J("ngStyle",i._getTicksStyles()),t.xp6(1),t.Q6J("ngStyle",i._getThumbContainerStyles()),t.xp6(5),t.Oqu(i.displayValue))},directives:[g.PC],styles:['.mat-slider{display:inline-block;position:relative;box-sizing:border-box;padding:8px;outline:none;vertical-align:middle}.mat-slider:not(.mat-slider-disabled):active,.mat-slider.mat-slider-sliding:not(.mat-slider-disabled){cursor:-webkit-grabbing;cursor:grabbing}.mat-slider-wrapper{-webkit-print-color-adjust:exact;color-adjust:exact;position:absolute}.mat-slider-track-wrapper{position:absolute;top:0;left:0;overflow:hidden}.mat-slider-track-fill{position:absolute;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-track-background{position:absolute;transform-origin:100% 100%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-ticks-container{position:absolute;left:0;top:0;overflow:hidden}.mat-slider-ticks{-webkit-background-clip:content-box;background-clip:content-box;background-repeat:repeat;box-sizing:border-box;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-container{position:absolute;z-index:1;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-focus-ring{position:absolute;width:30px;height:30px;border-radius:50%;transform:scale(0);opacity:0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider.cdk-keyboard-focused .mat-slider-focus-ring,.mat-slider.cdk-program-focused .mat-slider-focus-ring{transform:scale(1);opacity:1}.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb-label,.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb{cursor:-webkit-grab;cursor:grab}.mat-slider-thumb{position:absolute;right:-10px;bottom:-10px;box-sizing:border-box;width:20px;height:20px;border:3px solid transparent;border-radius:50%;transform:scale(0.7);transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-label{display:none;align-items:center;justify-content:center;position:absolute;width:28px;height:28px;border-radius:50%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-radius 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.cdk-high-contrast-active .mat-slider-thumb-label{outline:solid 1px}.mat-slider-thumb-label-text{z-index:1;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-sliding .mat-slider-track-fill,.mat-slider-sliding .mat-slider-track-background,.mat-slider-sliding .mat-slider-thumb-container{transition-duration:0ms}.mat-slider-has-ticks .mat-slider-wrapper::after{content:"";position:absolute;border-width:0;border-style:solid;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after,.mat-slider-has-ticks:hover:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after{opacity:1}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-disabled) .mat-slider-ticks,.mat-slider-has-ticks:hover:not(.mat-slider-disabled) .mat-slider-ticks{opacity:1}.mat-slider-thumb-label-showing .mat-slider-focus-ring{display:none}.mat-slider-thumb-label-showing .mat-slider-thumb-label{display:flex}.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:100% 100%}.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:0 0}.mat-slider:not(.mat-slider-disabled).cdk-focused.mat-slider-thumb-label-showing .mat-slider-thumb{transform:scale(0)}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label{border-radius:50% 50% 0}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label-text{opacity:1}.mat-slider:not(.mat-slider-disabled).cdk-mouse-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-touch-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-program-focused .mat-slider-thumb{border-width:2px;transform:scale(1)}.mat-slider-disabled .mat-slider-focus-ring{transform:scale(0);opacity:0}.mat-slider-disabled .mat-slider-thumb{border-width:4px;transform:scale(0.5)}.mat-slider-disabled .mat-slider-thumb-label{display:none}.mat-slider-horizontal{height:48px;min-width:128px}.mat-slider-horizontal .mat-slider-wrapper{height:2px;top:23px;left:8px;right:8px}.mat-slider-horizontal .mat-slider-wrapper::after{height:2px;border-left-width:2px;right:0;top:0}.mat-slider-horizontal .mat-slider-track-wrapper{height:2px;width:100%}.mat-slider-horizontal .mat-slider-track-fill{height:2px;width:100%;transform:scaleX(0)}.mat-slider-horizontal .mat-slider-track-background{height:2px;width:100%;transform:scaleX(1)}.mat-slider-horizontal .mat-slider-ticks-container{height:2px;width:100%}.cdk-high-contrast-active .mat-slider-horizontal .mat-slider-ticks-container{height:0;outline:solid 2px;top:1px}.mat-slider-horizontal .mat-slider-ticks{height:2px;width:100%}.mat-slider-horizontal .mat-slider-thumb-container{width:100%;height:0;top:50%}.mat-slider-horizontal .mat-slider-focus-ring{top:-15px;right:-15px}.mat-slider-horizontal .mat-slider-thumb-label{right:-14px;top:-40px;transform:translateY(26px) scale(0.01) rotate(45deg)}.mat-slider-horizontal .mat-slider-thumb-label-text{transform:rotate(-45deg)}.mat-slider-horizontal.cdk-focused .mat-slider-thumb-label{transform:rotate(45deg)}.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label,.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label-text{transform:none}.mat-slider-vertical{width:48px;min-height:128px}.mat-slider-vertical .mat-slider-wrapper{width:2px;top:8px;bottom:8px;left:23px}.mat-slider-vertical .mat-slider-wrapper::after{width:2px;border-top-width:2px;bottom:0;left:0}.mat-slider-vertical .mat-slider-track-wrapper{height:100%;width:2px}.mat-slider-vertical .mat-slider-track-fill{height:100%;width:2px;transform:scaleY(0)}.mat-slider-vertical .mat-slider-track-background{height:100%;width:2px;transform:scaleY(1)}.mat-slider-vertical .mat-slider-ticks-container{width:2px;height:100%}.cdk-high-contrast-active .mat-slider-vertical .mat-slider-ticks-container{width:0;outline:solid 2px;left:1px}.mat-slider-vertical .mat-slider-focus-ring{bottom:-15px;left:-15px}.mat-slider-vertical .mat-slider-ticks{width:2px;height:100%}.mat-slider-vertical .mat-slider-thumb-container{height:100%;width:0;left:50%}.mat-slider-vertical .mat-slider-thumb{-webkit-backface-visibility:hidden;backface-visibility:hidden}.mat-slider-vertical .mat-slider-thumb-label{bottom:-14px;left:-40px;transform:translateX(26px) scale(0.01) rotate(-45deg)}.mat-slider-vertical .mat-slider-thumb-label-text{transform:rotate(45deg)}.mat-slider-vertical.cdk-focused .mat-slider-thumb-label{transform:rotate(-45deg)}[dir=rtl] .mat-slider-wrapper::after{left:0;right:auto}[dir=rtl] .mat-slider-horizontal .mat-slider-track-fill{transform-origin:100% 100%}[dir=rtl] .mat-slider-horizontal .mat-slider-track-background{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:100% 100%}.mat-slider._mat-animation-noopable .mat-slider-track-fill,.mat-slider._mat-animation-noopable .mat-slider-track-background,.mat-slider._mat-animation-noopable .mat-slider-ticks,.mat-slider._mat-animation-noopable .mat-slider-thumb-container,.mat-slider._mat-animation-noopable .mat-slider-focus-ring,.mat-slider._mat-animation-noopable .mat-slider-thumb,.mat-slider._mat-animation-noopable .mat-slider-thumb-label,.mat-slider._mat-animation-noopable .mat-slider-thumb-label-text,.mat-slider._mat-animation-noopable .mat-slider-has-ticks .mat-slider-wrapper::after{transition:none}\n'],encapsulation:2,changeDetection:0}),n})();function S(n){return"t"===n.type[0]}function V(n,s){let e;return e=S(n)?"number"==typeof s?E(n.touches,s)||E(n.changedTouches,s):n.touches[0]||n.changedTouches[0]:n,e?{x:e.clientX,y:e.clientY}:void 0}function E(n,s){for(let e=0;e<n.length;e++)if(n[e].identifier===s)return n[e]}let ne=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[g.ez,k.BQ],k.BQ]}),n})(),re=(()=>{class n{constructor(e){this.gcodeViewerService=e,this.notRenderdLines=0,this.sliderUpdate=new t.vpe,this.timeEstimate=0}ngOnInit(){}sliderChanged(){this.sliderUpdate.emit(this.notRenderdLines)}formatTimeEstimate(e){let i=Math.floor(e/60%60),r=Math.floor(e/60/60),o="";return r>0&&(o+=r+"h "),o+=i+"min",o}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.k))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-select-lines-slider"]],inputs:{timeEstimate:"timeEstimate"},outputs:{sliderUpdate:"sliderUpdate"},decls:4,vars:4,consts:[[1,"renderdLinesSlider"],["step","100","aria-label","lines",3,"min","max","ngModel","ngModelChange","change"],[1,"timeEstimate"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"mat-slider",1),t.NdJ("ngModelChange",function(o){return i.notRenderdLines=o})("change",function(){return i.sliderChanged()}),t.qZA(),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.qZA()),2&e&&(t.xp6(1),t.Q6J("min",0)("max",i.gcodeViewerService.maxLines)("ngModel",i.notRenderdLines),t.xp6(2),t.hij("| ",i.formatTimeEstimate(i.timeEstimate),""))},directives:[z,O.JJ,O.On],styles:[".renderdLinesSlider[_ngcontent-%COMP%]{width:400px;border-radius:15px;background-color:#1f1f1f;border:2px solid #fff;display:flex;align-items:center;justify-content:center;padding:0 5px}.renderdLinesSlider[_ngcontent-%COMP%]   mat-slider[_ngcontent-%COMP%]{width:300px}.renderdLinesSlider[_ngcontent-%COMP%]   .timeEstimate[_ngcontent-%COMP%]{color:#fff}@media screen and (max-width: 700px){.renderdLinesSlider[_ngcontent-%COMP%]{width:92vw}.renderdLinesSlider[_ngcontent-%COMP%]   mat-slider[_ngcontent-%COMP%]{width:65vw}}"]}),n})();const se=function(n){return{"not-allowed":n}};let oe=(()=>{class n{constructor(e){this.siteStateService=e,this.clicked=new t.vpe}ngOnInit(){}startDraw(){this.siteStateService.appState.isDrawing||this.clicked.emit()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(T.y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-start-draw"]],outputs:{clicked:"clicked"},decls:2,vars:3,consts:[[1,"draw",3,"ngClass","click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return i.startDraw()}),t._uU(1," Draw it!\n"),t.qZA()),2&e&&t.Q6J("ngClass",t.VKq(1,se,i.siteStateService.appState.isDrawing))},directives:[g.mk],styles:[".draw[_ngcontent-%COMP%]{font-size:2em;padding:10px 0;width:200px;background-color:#0fa;border-radius:15px;box-shadow:8px 8px 10px #000;text-align:center;margin:5px;cursor:pointer}.draw.not-allowed[_ngcontent-%COMP%]{cursor:not-allowed;background-color:#777;color:#c5c5c5}@media screen and (max-width: 700px){.draw[_ngcontent-%COMP%]{font-size:1.5em;width:130px}}"]}),n})();var ae=l(4122);let le=(()=>{class n{constructor(e,i,r,o,a){this.gcodeViewerService=e,this.router=i,this.cameraService=r,this.backendConnectService=o,this.store=a}ngOnInit(){}cancle(){this.gcodeViewerService.gcodeFile="",this.gcodeViewerService.maxLines=0,this.cameraService.webcamImage=null,this.cameraService.base64Image=null,this.gcodeViewerService.isGeneratedGcode&&this.backendConnectService.cancle(),this.store.dispatch(new y.P(!1)),this.router.navigate(["start"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.k),t.Y36(m.F0),t.Y36(ae.i),t.Y36(x.U),t.Y36(P.yh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-cancle-button"]],decls:2,vars:0,consts:[[1,"cancle",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return i.cancle()}),t._uU(1,"Cancle"),t.qZA())},styles:[".cancle[_ngcontent-%COMP%]{font-size:2em;padding:10px 0;width:200px;background-color:#ff2600;border-radius:15px;box-shadow:8px 8px 10px #000;text-align:center;margin:5px;cursor:pointer}@media screen and (max-width: 700px){.cancle[_ngcontent-%COMP%]{font-size:1.5em;width:130px}}"]}),n})();function de(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",1),t._uU(1," Are you sure? "),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.no.emit(),r.showDialog=!1}),t._uU(4,"No"),t.qZA(),t.TgZ(5,"div",4),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.yes.emit(),r.showDialog=!1}),t._uU(6," Yes "),t.qZA(),t.qZA(),t.qZA()}}let B=(()=>{class n{constructor(){this.showDialog=!1,this.yes=new t.vpe,this.no=new t.vpe}ngOnInit(){}show(){this.showDialog=!0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-confirm-dialog"]],inputs:{showDialog:["show","showDialog"]},outputs:{yes:"yes",no:"no"},decls:1,vars:1,consts:[["class","confirm-dialog",4,"ngIf"],[1,"confirm-dialog"],[1,"buttons"],[1,"button","cancle",3,"click"],[1,"button","confirm",3,"click"]],template:function(e,i){1&e&&t.YNc(0,de,7,0,"div",0),2&e&&t.Q6J("ngIf",i.showDialog)},directives:[g.O5],styles:[".confirm-dialog[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:400px;height:150px;background-color:#fff;border:2px solid #000;border-radius:15px;padding:10px;display:flex;align-items:center;justify-content:center;flex-flow:column;font-size:2em}.confirm-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-flow:row}.confirm-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin:15px;padding:10px 30px;font-size:.8em;border:2px solid #000;border-radius:10px;cursor:pointer}.confirm-dialog[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]:hover{border:2px dashed #000}@media screen and (max-width: 800px){.confirm-dialog[_ngcontent-%COMP%]{width:70vw}}"]}),n})();const ce=["dialog"];let he=(()=>{class n{constructor(e,i,r){this.backendConnectService=e,this.gcodeViewerService=i,this.router=r}ngOnInit(){}del(){this.backendConnectService.delete(this.gcodeViewerService.gcodeId),this.router.navigate(["gcode","gallery"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.U),t.Y36(u.k),t.Y36(m.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-delete-button"]],viewQuery:function(e,i){if(1&e&&t.Gf(ce,5),2&e){let r;t.iGM(r=t.CRH())&&(i.confirmDialog=r.first)}},decls:4,vars:0,consts:[[1,"delete",3,"click"],[3,"yes"],["dialog",""]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return i.confirmDialog.show()}),t._uU(1,"Delete"),t.qZA(),t.TgZ(2,"app-confirm-dialog",1,2),t.NdJ("yes",function(){return i.del()}),t.qZA())},directives:[B],styles:[".delete[_ngcontent-%COMP%]{font-size:2em;padding:10px 0;width:200px;background-color:#f60;border-radius:15px;box-shadow:8px 8px 10px #000;text-align:center;margin:5px;cursor:pointer}@media screen and (max-width: 700px){.delete[_ngcontent-%COMP%]{font-size:1.5em;width:130px}}"]}),n})();function ge(n,s){1&n&&t._UZ(0,"app-delete-button")}let me=(()=>{class n{constructor(e,i,r,o,a){this.gcodeViewerService=e,this.backendConnectService=i,this.siteStateService=r,this.store=o,this.router=a,this.notRenderdLines=0,this.estimatedSeconds=0}ngOnInit(){screen.orientation.lock("portrait"),this.gcodeViewerService.$renderGcode.subscribe(()=>{var e;null===(e=this.renderer)||void 0===e||e.renderGcode(this.gcodeViewerService.gcodeFile,{notRenderdLines:0}),this.estimatedSeconds=this.gcodeViewerService.maxLines*p.N.avgTimePerLine,console.log(this.estimatedSeconds)})}ngAfterViewInit(){var e;null===(e=this.renderer)||void 0===e||e.renderGcode(this.gcodeViewerService.gcodeFile,{notRenderdLines:0}),this.estimatedSeconds=this.gcodeViewerService.maxLines*p.N.avgTimePerLine}sliderUpdated(e){var i;null===(i=this.renderer)||void 0===i||i.renderGcode(this.gcodeViewerService.gcodeFile,{notRenderdLines:e}),this.estimatedSeconds=(this.gcodeViewerService.maxLines-e)*p.N.avgTimePerLine,this.notRenderdLines=e}startDraw(){this.store.dispatch(new y.P(!0));let i=this.gcodeViewerService.gcodeFile.split("\n");console.log(this.notRenderdLines);let r=i.slice(0,-1*this.notRenderdLines).join("\n");r=this.applyOffset(r,p.N.drawingOffset),r+=p.N.endGcode,this.backendConnectService.postGcode(r),this.router.navigate(["gcode","drawing"])}applyOffset(e,i){let r=e.split("\n");for(let o=0;o<r.length;o++){let a=r[o];if(a.startsWith("G1")){let d=this.getG1Parameter(a);d[0]+=i[0],d[1]+=i[1],r[o]="G1 X"+d[0]+"Y "+d[1]}}return r.join("\n")}getG1Parameter(e){return[parseFloat(e.substring(e.indexOf("X")+1,e.lastIndexOf("Y")).trim()),parseFloat(e.substring(e.indexOf("Y")+1,e.length).trim())]}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.k),t.Y36(x.U),t.Y36(T.y),t.Y36(P.yh),t.Y36(m.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&t.Gf(M,5),2&e){let r;t.iGM(r=t.CRH())&&(i.renderer=r.first)}},decls:9,vars:2,consts:[[1,"navbar"],[1,"gcode-container"],[3,"timeEstimate","sliderUpdate"],[1,"controls"],[3,"clicked"],[4,"ngIf"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"app-navbar"),t.qZA(),t.TgZ(2,"div",1),t._UZ(3,"app-canvas-gcode-renderer"),t.TgZ(4,"app-select-lines-slider",2),t.NdJ("sliderUpdate",function(o){return i.sliderUpdated(o)}),t.qZA(),t.TgZ(5,"div",3),t.TgZ(6,"app-start-draw",4),t.NdJ("clicked",function(){return i.startDraw()}),t.qZA(),t._UZ(7,"app-cancle-button"),t.YNc(8,ge,1,0,"app-delete-button",5),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.Q6J("timeEstimate",i.estimatedSeconds),t.xp6(4),t.Q6J("ngIf",i.gcodeViewerService.gcodeId.length>0))},directives:[I.S,M,re,oe,le,g.O5,he],styles:[".gcode-container[_ngcontent-%COMP%]{padding-top:25px;position:absolute;display:flex;align-items:center;justify-content:center;flex-flow:column;width:100%;height:100%;overflow:hidden}.gcode-container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;flex-flow:row;flex-wrap:wrap;justify-content:center;align-items:center}.navbar[_ngcontent-%COMP%]{position:fixed;top:20px;width:100%;display:flex;align-items:center;justify-content:center;z-index:4}"]}),n})();const U=function(n){return{width:n}};let pe=(()=>{class n{constructor(e){this.gcodeViewerService=e,this.progress=0}ngOnInit(){}calcProgressInPercent(e,i){return Math.round(100*e/i)}calcRemainingTime(e,i){let r=(i-e)*p.N.avgTimePerLine,o=Math.floor(r/60%60),a=Math.floor(r/60/60),d="";return a>0&&(d+=a+"h "),d+=o+"min",d}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.k))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-drawing-progress-bar"]],inputs:{progress:"progress"},decls:6,vars:8,consts:[[1,"progress-container"],[1,"progress"],[1,"progress-bar","shadow",3,"ngStyle"],[1,"progress-bar",3,"ngStyle"],[1,"progress-info"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t._UZ(2,"span",2),t._UZ(3,"span",3),t.TgZ(4,"div",4),t._uU(5),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngStyle",t.VKq(4,U,i.calcProgressInPercent(i.progress,i.gcodeViewerService.maxLines)+"%")),t.xp6(1),t.Q6J("ngStyle",t.VKq(6,U,i.calcProgressInPercent(i.progress,i.gcodeViewerService.maxLines)+"%")),t.xp6(2),t.AsE(" ",i.calcProgressInPercent(i.progress,i.gcodeViewerService.maxLines),"% | ",i.calcRemainingTime(i.progress,i.gcodeViewerService.maxLines)," "))},directives:[g.PC],styles:[".progress-container[_ngcontent-%COMP%]{width:50vw;margin-top:10px}.progress-container[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{width:100%;height:30px;background:#e1e4e8;border-radius:20px;position:relative;box-sizing:border-box;max-width:100vw;display:flex;align-items:center}.progress-container[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]{color:#000;font-size:1.5em;z-index:5;width:100%;height:100%;display:flex;justify-content:center;align-items:center}.progress-container[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{display:block;height:100%;position:absolute;border-radius:20px;background:linear-gradient(90deg,#ffd33d,#ea4aaa 17%,#b34bff 34%,#01feff 51%,#ffd33d 68%,#ea4aaa 85%,#b34bff);background-size:300% 100%;animation:progress-animation 10s linear infinite;display:flex;align-items:center;justify-content:center;padding-top:3px}.progress-container[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]   .progress-bar.shadow[_ngcontent-%COMP%]{z-index:-1;top:5px;left:5px;filter:blur(4px)}@keyframes progress-animation{0%{background-position:100%}to{background-position:0}}@media (max-width: 900px){.progress-container[_ngcontent-%COMP%]{width:calc(100vw - 20px);margin-top:10px}}"]}),n})();const ue=["dialog"];let fe=(()=>{class n{constructor(e,i,r){this.backendConnectService=e,this.gcodeViewerService=i,this.router=r}ngOnInit(){}stop(){this.backendConnectService.stop(),this.router.navigate(["start"])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.U),t.Y36(u.k),t.Y36(m.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-stop-drawing-button"]],viewQuery:function(e,i){if(1&e&&t.Gf(ue,5),2&e){let r;t.iGM(r=t.CRH())&&(i.confirmDialog=r.first)}},decls:4,vars:0,consts:[[1,"stop",3,"click"],[3,"yes"],["dialog",""]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return i.confirmDialog.show()}),t._uU(1,"stop drawing"),t.qZA(),t.TgZ(2,"app-confirm-dialog",1,2),t.NdJ("yes",function(){return i.stop()}),t.qZA())},directives:[B],styles:[".stop[_ngcontent-%COMP%]{font-size:2em;padding:10px 0;width:200px;background-color:#f60;border-radius:15px;box-shadow:8px 8px 10px #000;text-align:center;margin:15px 5px;cursor:pointer}@media screen and (max-width: 700px){.stop[_ngcontent-%COMP%]{font-size:1.5em;width:130px}}"]}),n})();function ve(n,s){1&n&&t._UZ(0,"app-stop-drawing-button")}function _e(n,s){1&n&&(t.TgZ(0,"div",5),t._uU(1,"ready to draw!"),t.qZA())}let be=(()=>{class n{constructor(e,i,r,o,a){this.siteState=e,this.backendConnectService=i,this.gcodeViewerService=r,this.store=o,this.router=a,this.isDrawing=!1,this.drawingProgress=0}ngOnInit(){this.store.dispatch(new y.P(!1)),this.updateDrawingProgress()}ngAfterViewInit(){this.checkDrawingState(),setInterval(()=>{this.checkDrawingState()},p.N.appStateCheckInterval)}checkDrawingState(){this.isDrawing||(this.backendConnectService.getDrawenGcode().subscribe(e=>{var i;e.data&&e.isDrawing&&(this.gcodeViewerService.setGcodeFile(e.data,!1),null===(i=this.renderer)||void 0===i||i.renderGcode(this.gcodeViewerService.gcodeFile,{notRenderdLines:0,drawing:!0,drawingOffset:[-1*p.N.drawingOffset[0],-1*p.N.drawingOffset[1]]}))},e=>{0==e.status&&(this.siteState.serverOnline=!1,console.log("Server Offline!"),this.router.navigate([""]))}),this.backendConnectService.checkProgress().subscribe(e=>{this.isDrawing=e.isDrawing,this.isDrawing||(this.drawingProgress=0)}))}updateDrawingProgress(){this.backendConnectService.checkDrawingProgress().subscribe(e=>{var i;e.data&&(null===(i=this.renderer)||void 0===i||i.updateDrawingGcode(e.data),this.drawingProgress=e.data)}),setTimeout(()=>{this.updateDrawingProgress()},400)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(T.y),t.Y36(x.U),t.Y36(u.k),t.Y36(P.yh),t.Y36(m.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&t.Gf(M,5),2&e){let r;t.iGM(r=t.CRH())&&(i.renderer=r.first)}},decls:7,vars:3,consts:[[1,"navbar"],[1,"drawing-container"],[3,"progress"],[4,"ngIf"],["class","not-drawing",4,"ngIf"],[1,"not-drawing"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"app-navbar"),t.qZA(),t.TgZ(2,"div",1),t._UZ(3,"app-canvas-gcode-renderer"),t._UZ(4,"app-drawing-progress-bar",2),t.YNc(5,ve,1,0,"app-stop-drawing-button",3),t.YNc(6,_e,2,0,"div",4),t.qZA()),2&e&&(t.xp6(4),t.Q6J("progress",i.drawingProgress),t.xp6(1),t.Q6J("ngIf",i.isDrawing),t.xp6(1),t.Q6J("ngIf",!i.isDrawing))},directives:[I.S,M,pe,g.O5,fe],styles:[".drawing-container[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;flex-flow:column;width:100%;height:100%;padding-top:20px;overflow:hidden}.drawing-container[_ngcontent-%COMP%]   .not-drawing[_ngcontent-%COMP%]{font-size:2em;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100%;text-align:center}.navbar[_ngcontent-%COMP%]{position:fixed;top:20px;width:100%;display:flex;align-items:center;justify-content:center;z-index:4}"]}),n})();var we=l(9976),Ce=l(4879),xe=l(7480);function ye(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",7),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().loadGcodeById(o.name)}),t._UZ(2,"div",8),t._UZ(3,"img",9),t.qZA(),t.BQk()}if(2&n){const e=s.$implicit;t.xp6(3),t.Q6J("src","data:image/jpg;base64,"+e.image,t.LSH)}}function ke(n,s){1&n&&(t.TgZ(0,"div",10),t._UZ(1,"div"),t._UZ(2,"div"),t._UZ(3,"div"),t._UZ(4,"div"),t.qZA())}const Se=[{path:"",component:F,children:[{path:"editGcode",component:me},{path:"drawing",component:be},{path:"gallery",component:(()=>{class n{constructor(e,i,r,o,a){this.router=e,this.store=i,this.backendConnectService=r,this.gcodeViewerService=o,this.loadingService=a,this.faTimes=we.NBC,this.gallery=[],this.loadedElements=0,this.loadedAll=!1,this.loading=!1,this.autoLoadMoreDiffrence=1e3,this.elementLoadAmount=6}ngOnInit(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(this.elementLoadAmount=3),this.loadMore(this.elementLoadAmount),this.store.dispatch(new y.P(!1)),this.loadingService.isLoading=!1}onScroll(){this.getScrollHeight()-this.getYPosition()<=this.autoLoadMoreDiffrence&&this.loadMore(this.elementLoadAmount)}loadMore(e){this.loadedAll||this.loading||(this.loading=!0,this.backendConnectService.getGallery([this.loadedElements,this.loadedElements+e]).subscribe(i=>{this.gallery=this.gallery.concat(i.data),console.log(i.length),i.data.length<e&&(this.loadedAll=!0),this.loading=!1}),this.loadedElements+=e)}close(){this.store.dispatch(new y.P(!0)),this.router.navigate([""])}loadGcodeById(e){this.loadingService.isLoading=!0,this.loadingService.loadingText="loading Data",this.backendConnectService.getGcodeById(e).subscribe(i=>{this.loadingService.isLoading=!1,i.err?console.log(i.err):(this.gcodeViewerService.gcodeId=e,this.gcodeViewerService.setGcodeFile(i.data,!1),this.router.navigate(["gcode","editGcode"]))})}getYPosition(){return this.getScrollingElement().scrollTop}getScrollingElement(){return document.scrollingElement||document.documentElement}getScrollHeight(){return this.getScrollingElement().scrollHeight}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.F0),t.Y36(P.yh),t.Y36(x.U),t.Y36(u.k),t.Y36(Ce.b))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],hostBindings:function(e,i){1&e&&t.NdJ("scroll",function(){return i.onScroll()},!1,t.Jf7)},decls:11,vars:2,consts:[[1,"navbar"],[1,"header-container"],[1,"header"],[1,"gallery-container"],[4,"ngFor","ngForOf"],[1,"loading-container"],["class","lds-ring",4,"ngIf"],[1,"image-container",3,"click"],[1,"hover-bg"],[3,"src"],[1,"lds-ring"]],template:function(e,i){1&e&&(t._UZ(0,"app-loading"),t.TgZ(1,"div",0),t._UZ(2,"app-navbar"),t.qZA(),t.TgZ(3,"div",1),t.TgZ(4,"div",2),t.TgZ(5,"h1"),t._uU(6,"Gallery"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"div",3),t.YNc(8,ye,4,1,"ng-container",4),t.TgZ(9,"div",5),t.YNc(10,ke,5,0,"div",6),t.qZA(),t.qZA()),2&e&&(t.xp6(8),t.Q6J("ngForOf",i.gallery),t.xp6(2),t.Q6J("ngIf",!i.loadedAll))},directives:[xe.N,I.S,g.sg,g.O5],styles:[".navbar[_ngcontent-%COMP%]{position:fixed;top:20px;width:100%;display:flex;align-items:center;justify-content:center;z-index:4}.header-container[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;text-align:center;justify-content:center;margin-top:60px}.header-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin:45px;padding:0 40px;background-color:#fff;border:2px solid #000;border-radius:10px}.header-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:10px;font-size:4em}.gallery-container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;display:flex;align-items:center;flex-wrap:wrap;justify-content:center;padding-bottom:30px}.gallery-container[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{position:relative;margin:50px;cursor:pointer}.gallery-container[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   .hover-bg[_ngcontent-%COMP%]{border-radius:15px;z-index:-10;background:linear-gradient(90deg,#ffd33d,#ea4aaa 17%,#b34bff 34%,#01feff 51%,#ffd33d 68%,#ea4aaa 85%,#b34bff);position:absolute;width:100%;height:100%;transition:.4s ease-out;opacity:0;filter:blur(2px)}.gallery-container[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:5px 5px 0;z-index:2;width:20vw;border:2px solid #000;border-radius:15px;aspect-ratio:600/800;object-fit:cover;object-position:-5px 0}.gallery-container[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]:hover   .hover-bg[_ngcontent-%COMP%]{opacity:1}.gallery-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;padding-bottom:40px}.gallery-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .lds-ring[_ngcontent-%COMP%]{display:inline-block;position:relative;width:80px;height:80px}.gallery-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .lds-ring[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{box-sizing:border-box;display:block;position:absolute;width:64px;height:64px;margin:8px;border:2px solid #666666;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:#8dff89 transparent transparent transparent}.gallery-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .lds-ring[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(1){animation-delay:-.45s}.gallery-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .lds-ring[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){animation-delay:-.3s}.gallery-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .lds-ring[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media screen and (max-width: 700px){.header-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin:70px 0 0}.gallery-container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;display:flex;align-items:center;flex-wrap:wrap;justify-content:center}.gallery-container[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]{margin:10px}.gallery-container[_ngcontent-%COMP%]   .image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80vw}}"]}),n})()}]}];let Me=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[m.Bz.forChild(Se)],m.Bz]}),n})();var Pe=l(9577),Oe=l(2271);let De=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[g.ez,Me,ne,O.u5,Pe.uH,Oe.m]]}),n})()}}]);